b-tree insertion with very ugly c code 
